{"Name": "LUNG_3_DATA", "Header": "An interactive tour of a primary squamous cell carcinoma of the lung and adjacent non-neoplastic tissue surgically resected \nfrom a 44 year old female patient.\n\n[Explore another story](/featured-paper/du-lin-rashid-2019/figures/osd-LUNG_3) on histologic features \nfor this sample.\n", "Footer": "Note that the immunofluorescence signal for some markers (Keratin, IBA1, etc.) in this dataset are overexposed.\n", "PixelsPerMicron": 3.0769, "Images": [{"Name": "i0", "Description": "Primary Lung Cancer [M-003]", "Path": "https://s3.amazonaws.com/www.cycif.org/Nature-protocol-2019/LUNG_3", "Width": 14448, "Height": 11101, "MaxLevel": 4}], "Layout": {"Grid": [["i0"]]}, "DefaultGroup": "Nuclei", "Groups": [{"Path": "Structural-Components_0__DAPI--14__KERATIN--34__ASMA--22__CD45--33__IBA1", "Name": "Structural Components", "Colors": ["0000FF", "FFFFFF", "FF0000", "00FF00", "00FFFF"], "Channels": ["DNA", "Keratin", "\u03b1-SMA", "CD45", "IBA1"]}, {"Path": "PDL1-Expression_0__DAPI--14__KERATIN--19__PDL1--33__IBA1", "Name": "PD-L1 Expression", "Colors": ["0000FF", "FFFFFF", "FF0000", "00FFFF"], "Channels": ["DNA", "Keratin", "PD-L1", "IBA1"]}, {"Path": "B-Cells-and-T-Cells_0__DAPI--18__CD3D--35__CD20", "Name": "Lymphocytes", "Colors": ["0000FF", "FF0000", "FFFFFF"], "Channels": ["DNA", "CD3d", "CD20"]}, {"Path": "Regulatory-T-Cells-2_0__DAPI--18__CD3D--21__CD4--30__FOXP3", "Name": "Regulatory T-Cells", "Colors": ["0000FF", "FF0000", "00FF00", "FFFFFF"], "Channels": ["DNA", "CD3d", "CD4", "FOXP3"]}, {"Path": "Cytotoxic-T-Cells_0__DAPI--18__CD3D--23__CD8A", "Name": "Cytotoxic T-Cells", "Colors": ["0000FF", "FF0000", "00FF00"], "Channels": ["DNA", "CD3d", "CD8"]}, {"Path": "Inhibitory-T-Cells_0__DAPI--18__CD3D--15__PD1--30__FOXP3", "Name": "Inhibitory T-Cells", "Colors": ["0000FF", "FF0000", "00FF00", "FFFFFF"], "Channels": ["DNA", "CD3d", "PD1", "FOXP3"]}, {"Path": "Rare-Immune-Population-1_0__DAPI--21__CD4--23__CD8A--30__FOXP3", "Name": "CD8+/FOXP3+ T Cells", "Colors": ["0000FF", "00FF00", "FF0000", "FFFFFF"], "Channels": ["DNA", "CD4", "CD8A", "FOXP3"]}, {"Path": "Rare-Immune-Population-2_0__DAPI--21__CD4--23__CD8A--15__PD1--10__LAG3", "Name": "PD1+/LAG3+ T Cells", "Colors": ["0000FF", "00FF00", "FF0000", "00FFFF", "FFFFFF"], "Channels": ["DNA", "CD4", "CD8A", "PD1", "LAG3"]}, {"Path": "Macrophages_0__DAPI--33__IBA1--25__CD163", "Name": "Macrophages", "Colors": ["00FF00", "FF0000", "0000FF"], "Channels": ["IBA1", "CD163", "DNA"]}, {"Path": "Macrophages-(cont.)_0__DAPI--26__CD68--29__CD11B--27__CD14", "Name": "Macrophages (cont.)", "Colors": ["0000FF", "00FF00", "FFFFFF", "FF0000"], "Channels": ["DNA", "CD68", "CD11B", "CD14"]}, {"Path": "Nuclei_0__DAPI", "Name": "Nuclei", "Colors": ["FFFFFF"], "Channels": ["Hoechst"]}, {"Path": "KERATIN_14__KERATIN", "Name": "KERATIN", "Colors": ["FFFFFF"], "Channels": ["KERATIN"]}, {"Path": "ASMA_34__ASMA", "Name": "ASMA", "Colors": ["FF0000"], "Channels": ["ASMA"]}, {"Path": "CD45_22__CD45", "Name": "CD45", "Colors": ["00FF00"], "Channels": ["CD45"]}, {"Path": "IBA1_33__IBA1", "Name": "IBA1", "Colors": ["00FFFF"], "Channels": ["IBA1"]}, {"Path": "PDL1_19__PDL1", "Name": "PDL1", "Colors": ["FF0000"], "Channels": ["PDL1"]}, {"Path": "CD3D_18__CD3D", "Name": "CD3d", "Colors": ["FF0000"], "Channels": ["CD3d"]}, {"Path": "CD20_35__CD20", "Name": "CD20", "Colors": ["FFFFFF"], "Channels": ["CD20"]}, {"Path": "CD4_21__CD4", "Name": "CD4", "Colors": ["00FF00"], "Channels": ["CD4"]}, {"Path": "FOXP3_30__FOXP3", "Name": "FOXP3", "Colors": ["FF0000"], "Channels": ["FOXP3"]}, {"Path": "CD8A_23__CD8A", "Name": "CD8A", "Colors": ["00FF00"], "Channels": ["CD8A"]}, {"Path": "PD1_15__PD1", "Name": "PD1", "Colors": ["00FF00"], "Channels": ["PD1"]}, {"Path": "CD163_25__CD163", "Name": "CD163", "Colors": ["FF0000"], "Channels": ["CD163"]}, {"Path": "CD68_26__CD68", "Name": "CD68", "Colors": ["00FF00"], "Channels": ["CD68"]}, {"Path": "CD11B_29__CD11B", "Name": "CD11B", "Colors": ["FFFFFF"], "Channels": ["CD11B"]}, {"Path": null, "Name": "CD14_27__CD14", "Colors": "CD14 - FF0000", "Channels": ["CD14"]}, {"Path": "LAG3_10__LAG3", "Name": "LAG3", "Colors": ["FFFFFF"], "Channels": ["LAG3"]}], "Masks": [{"Name": "Cluster 1 - Tumor Cells", "Path": "datalayer/clustering/all_cell_types/cluster_1", "Colors": ["F44336"], "Channels": ["Tumor"]}, {"Name": "Cluster 2 - Stromal Cells", "Path": "datalayer/clustering/all_cell_types/cluster_4", "Colors": ["03A9F4"], "Channels": ["Stromal"]}, {"Name": "Cluster 3 - Immune Cells", "Path": "datalayer/clustering/all_cell_types/cluster_3", "Colors": ["4CAF50"], "Channels": ["Immune"]}, {"Name": "Cluster 4 - Other Cells", "Path": "datalayer/clustering/all_cell_types/cluster_2", "Colors": ["673AB7"], "Channels": ["Other"]}, {"Name": "All Clusters", "Path": "datalayer/clustering/merged_s40/level_0/cluster_id_all", "Colors": ["F44336"], "Channels": ["Segmentation"]}], "Stories": [{"Name": "", "Waypoints": [{"Name": "Data Aquisition", "Group": "Structural Components", "Audio": "/assets/audio/speech_20190918201043160.mp3", "Description": "Tissue cyclic immunofluorescence (t-CyCIF) was used to generate the fluorescence images.\n\nThe RareCyte CyteFinder microscope was used with a 40X/0.6NA objective.\n\nThe images were artifact corrected using the BaSiC tool, stitched and registered using the ASHLAR algorithm, \nand segmented using ilastik software and MATLAB. Single-cell features were then extracted from these images using HistoCAT software.\n\n![image](../../../assets/img/du-lin-rashid-nat-protoc-2019/Fig1_Rashid_SciData.JPG)\n\nRead more about the t-CyCIF method and this data in the following papers:\n\n[Lin et al., eLife, 2018](https://elifesciences.org/articles/31657)\n\n[Du, Lin, and Rashid et al., Nature Methods, 2019](https://www-nature-com.ezp-prod1.hul.harvard.edu/articles/s41596-019-0206-y)\n\n[Rashid et al., Scientific Data, 2019](https://www-nature-com.ezp-prod1.hul.harvard.edu/articles/s41597-019-0332-y)\n", "Zoom": 0.5, "Pan": [0.5, 0.5], "Overlay": {"x": 0.8681, "y": 0.5487, "width": 0, "height": 0}}, {"Name": "Cell Segmentation", "Group": "Nuclei", "Audio": "/assets/audio/speech_20190918201043160.mp3", "Description": "Cells in the image were segmented using an object detection method. Here, we used the Ilastik software\nto train a model that classifies pixels into three classes (nucleus, cytoplasm, and background). \nProbability masks generated by the model were used to perform morphological manipulations and \nwatershed in MATLAB to identify cells. \n\nWhile ~90% of the cells in this tissue are segmented accurately, there are some errors including \nfusions (undersegmented cells) and fissions (over segmented cells) as shown here.\nCell segmentation is a critical component of extracting quality single-cell data and \ncan affect the quality of downstream analysis; segmentation is thus an active area of development\nin the image analysis community.\n\nPan around the image and toggle the segmentation mask, or \"data layer\" below, to inspect the accuracy.\n", "Arrows": [{"Point": [0.48260891055109445, 0.7350125259339746], "Text": "fission", "HideArrow": false}, {"Point": [0.4766678746076962, 0.7409351253006583], "Text": "fusion", "HideArrow": false}], "Overlays": [{"x": 0.4601, "y": 0.7272, "width": 0.0421, "height": 0.0271}], "Zoom": 10.019, "Pan": [0.4774, 0.741], "ActiveMasks": ["Cluster 1 - Tumor Cells", "Cluster 2 - Stromal Cells", "Cluster 3 - Immune Cells", "Cluster 4 - Other Cells"], "Masks": ["Cluster 1 - Tumor Cells", "Cluster 2 - Stromal Cells", "Cluster 3 - Immune Cells", "Cluster 4 - Other Cells", "Cluster All"]}, {"Name": "K-means Clustering", "Group": "Structural Components", "Audio": "/assets/audio/speech_20190918201156545.mp3", "VisMatrix": {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}, "background": null}, "data": {"url": "/assets/visdata/clust4hpdat_LUNG-3-PR.csv"}, "mark": "rect", "encoding": {"color": {"type": "quantitative", "field": "frequency", "legend": {"direction": "horizontal", "orient": "bottom"}}, "x": {"type": "nominal", "field": "channel", "sort": ["KERATIN", "ASMA", "CD45"], "grid": false}, "y": {"type": "nominal", "field": "type", "sort": ["Tumor", "Stromal", "Immune", "Other"], "grid": false}}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {}, "width": "container"}, "VisBarChart": "/assets/visdata/cellCounts.csv", "clusters": {"labels": "Tumor,Other,Immune,Stromal", "colors": "e41a1c,377eb8,4daf4a,984ea3", "reorder": "Tumor,Stromal,Immune,Other"}, "axes": {"x": "KERATIN", "y": "CD45"}, "Description": "When single cells are clustered based on their expression of `Keratin`, `a-SMA`, and `CD45` \nusing the k-means algorithm, the cells fall into four cardinal clusters `:` \n1) A cluster of tumor cells with high keratin expression, \n2) a cluster of stromal cells with high `a-SMA` expression, \n3) a cluster of immune cells with high `CD45` expression, and \n4) a cluster of cells with low expression of all three markers.\n\nClick on each square of the heatmap to see the corresponsing cluster and immunoflourescence channel.\n\n`VisMatrix`\n\nThe number of cells belonging to each cluster is shown in the bar chart.\n\n`VisBarChart`\n\nClick on each of the clusters below to see which cells in the image belong to each cluster. You can also click on each bar of the chart to \nsee corresponding cells in the image.\n", "ActiveMasks": ["Cluster 1 - Tumor Cells", "Cluster 4 - Other Cells", "Cluster 3 - Immune Cells", "Cluster 2 - Stromal Cells"], "Masks": ["Cluster 1 - Tumor Cells", "Cluster 4 - Other Cells", "Cluster 3 - Immune Cells", "Cluster 2 - Stromal Cells"], "Zoom": 0.5, "Pan": [0.5, 0.5]}, {"Name": "Scatter Plot", "Group": "Structural Components", "Audio": "/assets/audio/speech_20190918201156545.mp3", "VisScatterplot": {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}, "background": null}, "data": {"url": "/assets/visdata/scatterplotExampleData_Medium.csv"}, "mark": {"type": "circle", "size": 60}, "encoding": {"color": {"type": "nominal", "field": "Cluster", "scale": {"domain": ["Tumor", "Other", "Immune", "Stromal"], "range": ["e41a1c", "984ea3", "4daf4a", "377eb8"]}, "legend": {"direction": "horizontal", "orient": "bottom"}}, "x": {"type": "quantitative", "field": "KERATIN", "scale": {"zero": false}, "grid": false}, "y": {"type": "quantitative", "field": "CD45", "scale": {"zero": false}, "grid": false}}, "transform": [{"lookup": "clust_ID", "from": {"data": {"name": "data-from-yaml"}, "key": "clust_ID", "fields": ["Cluster"]}}, {"filter": "(datum.Cluster !== None)"}], "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-from-yaml": [{"clust_ID": 1, "Cluster": "Tumor"}, {"clust_ID": 2, "Cluster": "Other"}, {"clust_ID": 3, "Cluster": "Immune"}, {"clust_ID": 4, "Cluster": "Stromal"}]}, "width": "container"}, "Description": "\nThe Scatterplot shows log normalized mean instensities (au) of KERATIN and CD45 for a sample of cells.\nClick on a data point in the plot to be taken to the cell in the image.\n\n`VisScatterplot`\n\nClick on each of the clusters below to see which cells in the image belong to each cluster.\n", "ActiveMasks": ["Cluster 1 - Tumor Cells", "Cluster 4 - Other Cells", "Cluster 3 - Immune Cells", "Cluster 2 - Stromal Cells"], "Masks": ["Cluster 1 - Tumor Cells", "Cluster 4 - Other Cells", "Cluster 3 - Immune Cells", "Cluster 2 - Stromal Cells"], "Zoom": 0.5, "Pan": [0.5, 0.5]}, {"Name": "UMAP", "Group": "Structural Components", "Audio": "/assets/audio/speech_20190918201156545.mp3", "VisScatterplot": {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}, "background": null}, "data": {"url": "/assets/visdata/LUNG_3_UMAP_data_20200218.csv"}, "mark": {"type": "circle", "size": 60}, "encoding": {"color": {"type": "nominal", "field": "Cluster", "scale": {"domain": ["Tumor", "Other", "Immune", "Stromal"], "range": ["e41a1c", "984ea3", "4daf4a", "377eb8"]}, "legend": {"direction": "horizontal", "orient": "bottom"}}, "x": {"type": "quantitative", "field": "UMAP_D1", "scale": {"zero": false}, "grid": false}, "y": {"type": "quantitative", "field": "UMAP_D2", "scale": {"zero": false}, "grid": false}}, "transform": [{"lookup": "clust_ID", "from": {"data": {"name": "data-from-yaml"}, "key": "clust_ID", "fields": ["Cluster"]}}, {"filter": "(datum.Cluster !== None)"}], "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-from-yaml": [{"clust_ID": 1, "Cluster": "Tumor"}, {"clust_ID": 2, "Cluster": "Other"}, {"clust_ID": 3, "Cluster": "Immune"}, {"clust_ID": 4, "Cluster": "Stromal"}]}, "width": "container"}, "Description": "\nA random sample of 2000 cells were selected and Uniform Manifold Approximation and Projection for Dimension Reduction (UMAP) \nwas performed. Click on a data point in the plot to be taken to the cell in the image.\n\n`VisScatterplot`\n\nClick on each of the clusters below to see which cells in the image belong to each cluster.\n", "ActiveMasks": ["Cluster 1 - Tumor Cells", "Cluster 4 - Other Cells", "Cluster 3 - Immune Cells", "Cluster 2 - Stromal Cells"], "Masks": ["Cluster 1 - Tumor Cells", "Cluster 4 - Other Cells", "Cluster 3 - Immune Cells", "Cluster 2 - Stromal Cells"], "Zoom": 0.5, "Pan": [0.5, 0.5]}, {"Name": "t-SNE", "Group": "Structural Components", "Audio": "/assets/audio/speech_20190918201156545.mp3", "VisScatterplot": {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}, "background": null}, "data": {"url": "/assets/visdata/LUNG_3_TSNE_data_20200224.csv"}, "mark": {"type": "circle", "size": 60}, "encoding": {"color": {"type": "nominal", "field": "Cluster", "scale": {"domain": ["Tumor", "Other", "Immune", "Stromal"], "range": ["e41a1c", "984ea3", "4daf4a", "377eb8"]}, "legend": {"direction": "horizontal", "orient": "bottom"}}, "x": {"type": "quantitative", "field": "TSNE_D1", "scale": {"zero": false}, "grid": false}, "y": {"type": "quantitative", "field": "TSNE_D2", "scale": {"zero": false}, "grid": false}}, "transform": [{"lookup": "clust_ID", "from": {"data": {"name": "data-from-yaml"}, "key": "clust_ID", "fields": ["Cluster"]}}, {"filter": "(datum.Cluster !== None)"}], "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-from-yaml": [{"clust_ID": 1, "Cluster": "Tumor"}, {"clust_ID": 2, "Cluster": "Other"}, {"clust_ID": 3, "Cluster": "Immune"}, {"clust_ID": 4, "Cluster": "Stromal"}]}, "width": "container"}, "Description": "\nA random sample of 2000 cells were selected and t-Distributed Stochastic Neighbor Embedding (t-SNE) \nwas performed. Click on a data point in the plot to be taken to the cell in the image.\n\n`VisScatterplot`\n\nClick on each of the clusters below to see which cells in the image belong to each cluster.\n", "ActiveMasks": ["Cluster 1 - Tumor Cells", "Cluster 4 - Other Cells", "Cluster 3 - Immune Cells", "Cluster 2 - Stromal Cells"], "Masks": ["Cluster 1 - Tumor Cells", "Cluster 4 - Other Cells", "Cluster 3 - Immune Cells", "Cluster 2 - Stromal Cells"], "Zoom": 0.5, "Pan": [0.5, 0.5]}, {"Name": "Immune Populations", "Group": "Lymphocytes", "Audio": "/assets/audio/speech_20190918201656247.mp3", "Description": "Many immune populations are present in this lung cancer and are often \nenriched in the tumor region.\n\nWhen the subset of CD45 positive cells was clustered based on expression \nof CD45, CD3d, CD8A, CD4, CD20, PD1, and FOXP3 using k-means, \nseven distinct immune cell populations emerged.\n\nThe populations are shown in the heat map below, where each row represents \na cluster and each column represents an immune marker. \nThe color represents the expression level of each marker.\n", "VisMatrix": {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}, "background": null}, "data": {"url": "/assets/visdata/clust7hpdat_LUNG-3-PR.csv"}, "mark": "rect", "encoding": {"color": {"type": "quantitative", "field": "frequency", "legend": {"direction": "horizontal", "orient": "bottom"}}, "x": {"type": "nominal", "field": "channel", "sort": ["CD45", "CD3D", "CD8A", "CD4", "CD20", "PD1", "FOXP3"], "grid": false}, "y": {"type": "nominal", "field": "type", "sort": ["Regulatory T", "Helper T", "CD45+ Immune", "CD45+ Immune ", "B Cell", "Cytotoxic T", "PD1+ Cytotoxic T"], "grid": false}}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {}, "width": "container"}, "Zoom": 5.5411, "Pan": [1.05, 0.3216], "Overlay": {"x": 1.0132, "y": 0.2906, "width": 0.0947, "height": 0.0671}}]}]}